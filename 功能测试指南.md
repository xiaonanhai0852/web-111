# 元器件管理系统 - 功能测试指南

## 一、测试准备

### 1.1 环境要求
- ✅ 后端服务已启动（http://localhost:8080）
- ✅ 数据库已初始化（导入示例数据）
- ✅ 浏览器（推荐Chrome或Edge）

### 1.2 测试账号
| 角色 | 用户名 | 密码 | 用途 |
|------|--------|------|------|
| 管理员 | admin | admin123 | 测试管理员功能 |
| 普通用户 | user | user123 | 测试普通用户功能 |

## 二、管理员功能测试

### 测试1：管理员登录

**测试步骤：**
1. 打开 `前端/登录.html`
2. 选择"管理员"角色
3. 输入用户名：admin
4. 输入密码：admin123
5. 点击"登录"按钮

**预期结果：**
- ✅ 登录成功，跳转到元器件管理页面
- ✅ 右上角显示"admin"和"管理员"标签
- ✅ 可以看到6个标签：入库管理、取用管理、库存统计、元器件类型管理、供应商管理、用户管理

### 测试2：添加供应商

**测试步骤：**
1. 点击"供应商管理"标签
2. 填写供应商信息：
   - 名称：测试供应商
   - 电话：0755-88888888
   - 邮箱：test@example.com
   - 联系人：测试经理
3. 点击"添加供应商"按钮

**预期结果：**
- ✅ 显示"添加成功"提示
- ✅ 供应商列表自动刷新
- ✅ 新供应商出现在列表中

### 测试3：添加元器件类型

**测试步骤：**
1. 点击"元器件类型管理"标签
2. 填写元器件信息：
   - 名称：测试电阻
   - 型号：TEST-100KΩ（必须唯一）
   - 供应商：选择刚才添加的供应商
   - 单价：0.10
3. 点击"添加元器件类型"按钮

**预期结果：**
- ✅ 显示"添加成功"提示
- ✅ 元器件类型列表自动刷新
- ✅ 新类型出现在列表中
- ✅ 入库和取用页面的下拉框中也出现新类型

### 测试4：查看用户列表

**测试步骤：**
1. 点击"用户管理"标签
2. 查看用户列表

**预期结果：**
- ✅ 显示用户列表（包括admin和user）
- ✅ 显示用户的学号、姓名、邮箱、角色等信息
- ✅ 管理员显示蓝色标签，普通用户显示绿色标签

## 三、普通用户功能测试

### 测试5：普通用户登录

**测试步骤：**
1. 退出当前登录（点击右上角"退出登录"）
2. 选择"普通用户"角色
3. 输入用户名：user
4. 输入密码：user123
5. 点击"登录"按钮

**预期结果：**
- ✅ 登录成功，跳转到元器件管理页面
- ✅ 右上角显示"user"和"普通用户"标签
- ✅ 只能看到3个标签：入库管理、取用管理、库存统计
- ❌ 看不到：元器件类型管理、供应商管理、用户管理

### 测试6：入库操作

**测试步骤：**
1. 点击"入库管理"标签
2. 选择元器件类型：电阻 - 10KΩ
3. 填写入库数量：100
4. 选择采购日期：当前日期
5. 填写采购人姓名：测试用户
6. 填写批次号：TEST20240125
7. 点击"提交入库"按钮

**预期结果：**
- ✅ 显示"入库成功"提示
- ✅ 表单自动清空
- ✅ 库存统计中该元器件的库存增加100

### 测试7：取用操作（库存充足）

**测试步骤：**
1. 点击"取用管理"标签
2. 选择元器件类型：电阻 - 10KΩ
3. 查看当前库存（应该显示绿色数字）
4. 填写取用数量：10（小于库存）
5. 填写取用人姓名：测试用户
6. 填写取用目的：功能测试
7. 填写项目名称：系统测试
8. 点击"提交取用"按钮

**预期结果：**
- ✅ 显示"取用成功"提示
- ✅ 表单自动清空
- ✅ 库存统计中该元器件的库存减少10

### 测试8：取用操作（库存不足）

**测试步骤：**
1. 选择一个库存较少的元器件（如库存只有5个）
2. 填写取用数量：10（大于库存）
3. 填写其他必填信息
4. 点击"提交取用"按钮

**预期结果：**
- ❌ 显示"库存不足！当前库存：5，需要：10"
- ❌ 取用失败
- ✅ 库存数量不变

### 测试9：库存统计查询

**测试步骤：**
1. 点击"库存统计"标签
2. 点击"刷新统计"按钮
3. 查看统计表格

**预期结果：**
- ✅ 显示所有元器件的库存信息
- ✅ 库存数量正确（= 入库总量 - 取用总量）
- ✅ 库存充足的显示绿色，库存不足的显示红色
- ✅ 显示库存价值（库存 × 单价）

## 四、权限控制测试

### 测试10：普通用户访问管理员功能

**测试步骤：**
1. 以普通用户身份登录
2. 尝试查看管理员专用标签

**预期结果：**
- ❌ 看不到"元器件类型管理"标签
- ❌ 看不到"供应商管理"标签
- ❌ 看不到"用户管理"标签
- ✅ 只能看到普通用户功能

### 测试11：未登录访问系统

**测试步骤：**
1. 清除浏览器localStorage（F12 → Application → Local Storage → Clear）
2. 直接访问 `元器件管理.html`

**预期结果：**
- ✅ 自动跳转到登录页面
- ❌ 无法访问管理页面

## 五、业务逻辑测试

### 测试12：型号唯一性检查

**测试步骤：**
1. 以管理员身份登录
2. 添加元器件类型，型号为：10KΩ（已存在）
3. 点击提交

**预期结果：**
- ❌ 显示错误提示（型号已存在）
- ❌ 添加失败

### 测试13：库存动态计算

**测试步骤：**
1. 记录某个元器件的当前库存：X
2. 入库100个
3. 查看库存统计，应该是：X + 100
4. 取用50个
5. 查看库存统计，应该是：X + 100 - 50 = X + 50

**预期结果：**
- ✅ 库存计算正确
- ✅ 每次操作后库存实时更新

### 测试14：取用历史记录

**测试步骤：**
1. 取用某个元器件
2. 在Swagger中访问：GET /api/component/stock-out/history/{id}
3. 查看返回的历史记录

**预期结果：**
- ✅ 显示该元器件的所有取用记录
- ✅ 包含取用人、数量、时间、目的等信息
- ✅ 按时间倒序排列

## 六、API接口测试

### 测试15：使用Swagger测试API

**测试步骤：**
1. 访问 http://localhost:8080/swagger-ui/index.html
2. 找到"元器件管理接口"
3. 测试 POST /api/component/stock-out 接口
4. 填写请求体：
```json
{
  "componentTypeId": 1,
  "quantity": 5,
  "userId": 2,
  "userName": "测试用户",
  "purpose": "API测试",
  "projectName": "接口测试"
}
```
5. 点击Execute

**预期结果：**
- ✅ 返回200状态码
- ✅ 返回JSON：{"success": true, "message": "取用成功"}
- ✅ 库存正确扣减

### 测试16：测试库存统计API

**测试步骤：**
1. 在Swagger中找到"统计查询接口"
2. 测试 GET /api/statistics/inventory
3. 点击Execute

**预期结果：**
- ✅ 返回所有元器件的库存统计
- ✅ 数据格式正确
- ✅ 库存数量准确

## 七、异常情况测试

### 测试17：参数验证

**测试步骤：**
1. 尝试提交空表单
2. 尝试输入负数数量
3. 尝试输入非法字符

**预期结果：**
- ✅ 显示参数错误提示
- ✅ 不允许提交
- ✅ 表单验证生效

### 测试18：网络异常

**测试步骤：**
1. 停止后端服务
2. 尝试进行入库或取用操作

**预期结果：**
- ✅ 显示网络错误提示
- ✅ 不会导致页面崩溃

## 八、测试检查清单

### 功能测试
- [ ] 管理员登录
- [ ] 普通用户登录
- [ ] 添加供应商
- [ ] 添加元器件类型
- [ ] 入库操作
- [ ] 取用操作（库存充足）
- [ ] 取用操作（库存不足）
- [ ] 库存统计查询
- [ ] 查看取用历史

### 权限测试
- [ ] 管理员可以访问所有功能
- [ ] 普通用户只能访问基本功能
- [ ] 未登录自动跳转登录页

### 业务逻辑测试
- [ ] 型号唯一性检查
- [ ] 库存动态计算正确
- [ ] 库存不足时拒绝取用
- [ ] 流水记录完整保存

### API测试
- [ ] 所有API接口正常响应
- [ ] 返回数据格式正确
- [ ] 错误处理完善

## 九、测试报告模板

```
测试日期：2024-01-25
测试人员：XXX
测试环境：本地开发环境

测试结果：
✅ 通过：XX项
❌ 失败：XX项
⚠️  警告：XX项

详细说明：
1. 功能测试：全部通过
2. 权限测试：全部通过
3. 业务逻辑测试：全部通过
4. API测试：全部通过

发现的问题：
1. 无

建议：
1. 建议添加更多的表单验证
2. 建议优化错误提示信息
```

---

**测试指南版本：** v1.0  
**最后更新：** 2024-01-25  
**维护团队：** 元器件管理系统开发团队

